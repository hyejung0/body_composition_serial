
<!-- README.md is generated from README.Rmd. Please edit that file -->

# Code

<!-- badges: start -->
<!-- badges: end -->

This file displays working example of joint modeling of longitudinal
outcome using linear mixed effect model and survival outcome using Cox
model. The longitudinal process is body composition and survival outcome
is death.

## Models

<div class="img-float">

<img src="spine_image.jpg"
style="float: left; margin: 5px; width: 300px;" />

</div>

We are interested in modeling the changes of body composition
(longitudinal outcome) as well as the impact of the changes body
composition on survival (survival outcome). To do so, we must perform
joint modelling approach, rather than fitting separate survival and
longitudinal models. There are two reasons for such approach. First,
when performing survival modeling with time-dependent covariate, the
covariate is required to be external. That is, the body composition at
time point t is not affected by death at time point u, with t\>u 1.
However, the body composition over time does not satisfy this condition,
due to the fact that they are the output of a stochastic process
generated by the patient, which is directly related to the death
mechanism. Therefore, in order to produce valid inferences, a model for
the joint distribution of the longitudinal and survival outcomes is
required instead. The second reason is because death causes dropout in
the longitudinal measurement since no longitudinal measurements are
available at and after death time. We believe that this dropout is
nonrandom (i.e. the probability of dropout depends on the unobserved
longitudinal response), which may induce bias from an analysis that
ignores the dropout process2.

Baseline hazard function that estimate a relative risk of death based on
true and unobserved value of the longitudinal outcome is left
unspecified. Or we may change to accelerated failure time (AFT) model.
The perks of using AFT instead Cox PH model is that the subject-specific
risk at time t depends on the entire body composition history up to time
t, whereas for the Cox PH model, the subject-specific risk depends only
on the current value of the body composition.

We need the body composition for each time point t, where death occurs.
We do not have this value, so we reconstruct the complete longitudinal
history using linear mixed effect model. We modeled each body
composition based on age at metastatic diagnosis, gender, smoking
history, race ethnicity and longitudinal effect of age. Because the data
are inherently unbalanced, the random intercept and slope were included
to account for the repeated observation on the same patient in the
covariance structure.

What is special about using `README.Rmd` instead of just `README.md`?
You can include R chunks like so:

``` r
summary(cars)
#>      speed           dist       
#>  Min.   : 4.0   Min.   :  2.00  
#>  1st Qu.:12.0   1st Qu.: 26.00  
#>  Median :15.0   Median : 36.00  
#>  Mean   :15.4   Mean   : 42.98  
#>  3rd Qu.:19.0   3rd Qu.: 56.00  
#>  Max.   :25.0   Max.   :120.00
```

You’ll still need to render `README.Rmd` regularly, to keep `README.md`
up-to-date.

You can also embed plots, for example:

<img src="man/figures/README-pressure-1.png" width="100%" />

In that case, don’t forget to commit and push the resulting figure
files, so they display on GitHub.
